# 诗歌生成与判别系统

## 项目概述

本项目是一个基于深度学习的诗歌生成与判别系统，使用PyTorch框架实现。系统包含两个主要组件：
1. **诗歌生成器**：基于LSTM网络，能够根据用户输入的开头词或字自动生成诗歌
2. **诗歌判别器**：基于CNN网络，用于判断生成的诗歌是否"真实"

系统采用GAN（生成对抗网络）的训练方式，通过生成器和判别器的对抗训练不断提高诗歌生成的质量。

## 功能特点

- 支持用户输入起始词或字生成完整诗歌
- 生成过程中考虑温度参数控制生成多样性
- 自动去除标点符号和特殊字符的干扰
- 支持中文字符的直接处理
- 训练过程可视化（损失函数曲线）

## 文件结构

```
.
├── config.py            # 配置文件（超参数、常量等）
├── evaluation.py        # 模型评估与交互界面
├── models.py            # 模型定义（生成器、判别器）
├── pretrain.py          # 预训练逻辑
├── pretrain_discriminator.py  # 判别器预训练脚本
├── pretrain_gan.py      # GAN训练脚本
├── pretrain_generator.py # 生成器预训练脚本
└── tools.py             # 工具函数（数据处理、训练辅助等）
```

## 技术细节

### 主要模型

1. **诗歌生成器 (PoetryGenerator)**
   - 基于LSTM网络
   - 包含嵌入层、LSTM层和全连接层
   - 支持温度参数控制生成多样性

2. **诗歌判别器 (PoetryDiscriminator)**
   - 基于CNN网络
   - 使用多种卷积核尺寸捕捉不同粒度的特征
   - 包含嵌入层、卷积层和全连接层

### 训练流程

1. **预训练生成器**：使用最大似然估计训练生成器
2. **预训练判别器**：使用生成器生成的样本和真实样本训练判别器
3. **GAN训练**：交替训练生成器和判别器

### 关键参数

- 最大生成长度：40
- 隐藏层大小：256
- 词向量维度：128
- LSTM层数：2
- 温度参数：0.8
- 批次大小：32

## 使用方法

### 训练模型

1. 预训练生成器：
   ```bash
   python pretrain_generator.py
   ```

2. 预训练判别器：
   ```bash
   python pretrain_discriminator.py
   ```

3. 训练GAN：
   ```bash
   python pretrain_gan.py
   ```

### 生成诗歌

运行评估脚本并输入起始词：
```bash
python evaluation.py
```

示例交互：
```
输入开头的词或者字：春风
春风拂面花满枝，柳絮飞舞燕归时。
```

## 依赖环境

- Python 3.x
- PyTorch
- jieba (用于分词)
- loguru (日志记录)
- matplotlib (可视化)
- tqdm (进度条)

## 未来改进方向

1. 增加更多诗歌风格选项
2. 改进生成质量评估指标
3. 支持更长的诗歌生成
4. 增加用户自定义词典功能
5. 开发Web界面

## 贡献指南

欢迎提交Pull Request或Issue。主要开发方向包括：
- 模型性能优化
- 新功能开发
- 文档改进
- Bug修复

## 许可证

本项目采用MIT许可证。详情请见LICENSE文件。

---

*注：使用前请确保已安装所有依赖项，并准备好训练数据（默认路径为`./data/sample_poetry.txt`）。*